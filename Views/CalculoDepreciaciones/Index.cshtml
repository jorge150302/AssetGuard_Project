@model IEnumerable<AssetGuard_Project.Models.CalculoDepreciacion>

@{
    ViewData["Title"] = "Index";
}

<h1>Cálculo Depreciaciónes</h1>

<p>
    <a asp-action="Create" class="btn btn-outline-primary">Crear</a>
</p>

<form asp-controller="CalculoDepreciaciones" asp-action="Index">
    <p>
        <input type="text" name="term" />
        <input type="submit" value="Buscar" />
    </p>
</form>

<h2>Enviar JSON en MVC</h2>

<!-- Campos para recopilar la información -->
<div>
    <label for="descripcion">Descripción:</label>
    <input type="text" id="descripcion" />
</div>
<div>
    <label for="auxiliar">Auxiliar:</label>
    <input type="number" id="auxiliar" />
</div>
<div>
    <label for="cuentaDB">Cuenta DB:</label>
    <input type="number" id="cuentaDB" />
</div>
<div>
    <label for="cuentaCR">Cuenta CR:</label>
    <input type="number" id="cuentaCR" />
</div>
<div>
    <label for="monto">Monto:</label>
    <input type="number" id="monto" step="0.01" />
</div>

<!-- Botón para enviar el JSON -->
<button id="btnEnviar">Enviar JSON</button>

<!-- Div para mostrar resultados de la respuesta de la API (opcional) -->
<div id="resultado"></div>

<!-- Div para mostrar el JSON enviado (opcional) -->
<div id="jsonEnviado"></div>
@section scripts {
    <script>
        // Script para manejar el clic del botón
        document.getElementById("btnEnviar").addEventListener("click", function () {
            enviarJSON();
        });

        // Función para enviar el JSON a la API
        function enviarJSON() {
            // Recopilar los datos de los campos
            var descripcion = document.getElementById("descripcion").value;
            var auxiliar = document.getElementById("auxiliar").value;
            var cuentaDB = document.getElementById("cuentaDB").value;
            var cuentaCR = document.getElementById("cuentaCR").value;
            var monto = document.getElementById("monto").value;
  

            // Crear el objeto con la información
            var dataToSend =
            {
                "descripcion": "juan pablo klk",
                "auxiliar": 1,
                "cuentaDB": 1,
                "cuentaCR": 1,
                "monto": 1000.45
            };


            // Realizar la solicitud POST a la API
            fetch("/CalculoDepreciaciones/EnviarJSON", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(dataToSend)
            })
                .then(response => response.text())
                .then(data => {
                    // Mostrar la respuesta de la API
                    // Mostrar el JSON enviado en el div de JSON
                    document.getElementById("jsonEnviado").innerText = JSON.stringify(dataToSend, null, 2);

                    document.getElementById("resultado").innerText = data;
                })
                .catch(error => console.error("Error al enviar el JSON:", error));
        }
    </script>
}




<table class="table">
    <thead>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.AnoProcesoCd)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.MesProcesoCd)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FechaProcesoCd)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.MontoDepreciadoCd)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DepreciacionAcumuladaCd)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.CuentaCompra)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.CuentaDepreciacion)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ActivoFijoCdNavigation)
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
@foreach (var item in Model) {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.AnoProcesoCd)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.MesProcesoCd)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.FechaProcesoCd)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.MontoDepreciadoCd)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.DepreciacionAcumuladaCd)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.CuentaCompra)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.CuentaDepreciacion)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ActivoFijoCdNavigation.DescripcionAf)
            </td>
                <td>
                    <a asp-action="Edit" asp-route-id="@item.IdCd" class="btn btn-warning">Editar</a> |
                    <a asp-action="Details" asp-route-id="@item.IdCd" class="btn btn-secondary">Detalles</a> |
                    <a asp-action="Delete" asp-route-id="@item.IdCd" class="btn btn-danger">Borrar</a>
                </td>
        </tr>
}
    </tbody>
</table>
